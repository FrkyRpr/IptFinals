<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>
        Build a Survey Form using HTML and CSS
    </title>


    <script>
      const departments = ["NP", "CSP", "TEP"];
      const courses = {
        NP: ["Nursing"],
        CSP: ["BSIT", "BSIT-CA", "DPIT", "DIT"],
        TEP: ["Math Major", "English Major"],
      };
      const commonQuestions = [
        { label: "Enter your name", type: "text"},
        { label: "Enter your email", type: "text"},
        { label: "Input your age", type: "number"},

        {
          label: "What year are you in?",
          type: "select",
          values: ["1st Year", "2nd Year", "3rd Year", "4th Year"],
        },
        {
          label: "Did you choose this course?",
          type: "checkbox",
          values: ["Yes", "No"],
        },
        { label: "Why did you choose this course?", type: "textarea" },
        
      ];
      const courseQuestions = {
        Nursing: [
          {
            label: "Nursing Question 1",
            type: "select",
            values: ["choice1", "choice2", "choice3", "choice4", "choice5"],
          },
          {
            label: "Nursing Question 2",
            type: "checkbox",
            values: ["value1", "value2", "value3"],
          },
          { label: "Nursing Question 3", type: "text" },
          { label: "Nursing Question 4", type: "textarea" },
          {
            label: "Nursing Question 5",
            type: "radio",
            values: ["value1", "value2", "value3"],
          },
        ],
 
        BSIT: [
          {
            label: "BSIT Question 1",
            type: "text",
            values: ["choice1", "choice2", "choice3", "choice4", "choice5"],
          },
          {
            label: "What programming languages have you learned?",
            type: "checkbox",
            values: ["Python", "Java", "JavaScript", "C++", "CSS", "C#"],
          },
          {
            label: "What projects have you made this school year?",
            type: "text",
          },
          { label: "BSIT Question 4", type: "textarea" },
        ],
        "BSIT-CA": [
          {
            label: "BSIT-CA Question 1",
            type: "select",
            values: ["choice1", "choice2", "choice3", "choice4", "choice5"],
          },
          {
            label: "BSIT-CA Question 2",
            type: "checkbox",
            values: ["value1", "value2", "value3"],
          },
          { label: "BSIT-CA Question 3", type: "text" },
          { label: "BSIT-CA Question 4", type: "textarea" },
        ],
        DPIT: [
          {
            label: "DPIT Question 1",
            type: "select",
            values: ["choice1", "choice2", "choice3", "choice4", "choice5"],
          },
          {
            label: "DPIT Question 2",
            type: "checkbox",
            values: ["value1", "value2", "value3"],
          },
          { label: "DPIT Question 3", type: "text" },
          { label: "DPIT Question 4", type: "textarea" },
        ],
        DIT: [
          {
            label: "DIT Question 1",
            type: "select",
            values: ["choice1", "choice2", "choice3", "choice4", "choice5"],
          },
          {
            label: "DIT Question 2",
            type: "checkbox",
            values: ["value1", "value2", "value3"],
          },
          { label: "DIT Question 3", type: "text" },
          { label: "DIT Question 4", type: "textarea" },
        ],
 
        "Math Major": [
          {
            label: "Math Major 1",
            type: "select",
            values: ["choice1", "choice2", "choice3", "choice4", "choice5"],
          },
          {
            label: "Math Major 2",
            type: "checkbox",
            values: ["value1", "value2", "value3"],
          },
          { label: "Math Major 3", type: "text" },
          { label: "Math Major 4", type: "textarea" },
        ],
        "English Major": [
          {
            label: "English Major Question 1",
            type: "select",
            values: ["choice1", "choice2", "choice3", "choice4", "choice5"],
          },
          {
            label: "English Major Question 2",
            type: "checkbox",
            values: ["value1", "value2", "value3"],
          },
          { label: "English Major Question 3", type: "text" },
          { label: "English Major Question 4", type: "textarea" },
        ],
      };
    </script>
  </head>
 
  <body>
    <h1>College Student Survey Form</h1>
    <div id="form">
      
 
      <div id="generalInfo-collapse" class="hidden">&#9660;</div>
      <div id="choices" class="form-control">
        <div id="departmentSection">
          <label>Choose a Department*</label>
          <select id="departments" name="departments"></select>
        </div>
        <div id="coursesSection" class="hidden">
          <label>Choose a Course*</label>
          <select id="courses" name="courses"></select>
        </div>
      </div>
      <div id="questionsSection" class="hidden"></div>
      <button id="nextButton">Next</button>
      <button id="submitButton" class="hidden">Submit</button>
    </div>
 
    <script>
      const validateInput = (element) => {
        switch (element.type) {
          case "text": {
            if (element.value) {
              element.classList.remove("inError");
            } else {
              element.classList.add("inError");
            }
            return !!element.value;
          }
          case "select-one": {
            if (element.selectedIndex > 0) {
              element.classList.remove("inError");
            } else {
              element.classList.add("inError");
            }
            return !!element.value;
          }
          case "radio": {
            if (element.value) {
              element.classList.remove("inError");
            } else {
              element.classList.add("inError");
            }
            return !!element.value;
          }
          case "checkbox": {
            const isValid = Array.from(
              element.parentElement.parentElement.querySelectorAll(
                'input[type="checkbox"]'
              )
            ).some((e) => e.checked);
            if (isValid) {
              element.classList.remove("inError");
            } else {
              element.classList.add("inError");
            }
            return isValid;
          }
          case "textarea": {
            if (element.value) {
              element.classList.remove("inError");
            } else {
              element.classList.add("inError");
            }
            return !!element.value;
          }
        }
      };
      const hasClass = (element, className) => {
        return !!(
          element &&
          element.classList &&
          element.classList.contains(className)
        );
      };
      const hide = (...ids) => {
        ids.forEach((id) => {
          const element = document.getElementById(id);
          if (element && !hasClass(element, "hidden")) {
            element.classList.add("hidden");
          }
        });
      };
      const show = (...ids) => {
        ids.forEach((id) => {
          const element = document.getElementById(id);
          if (element && hasClass(element, "hidden")) {
            element.classList.remove("hidden");
          }
        });
      };
      const enable = (...ids) => {
        ids.forEach((id) => {
          const element = document.getElementById(id);
          if (element) {
            element.disabled = false;
          }
        });
      };
      const disable = (...ids) => {
        ids.forEach((id) => {
          const element = document.getElementById(id);
          if (element) {
            element.disabled = true;
          }
        });
      };
      const clear = (...ids) => {
        ids.forEach((id) => {
          const element = document.getElementById(id);
          if (element) {
            element.innerHTML = "";
          }
        });
      };
 
      const getDefaultSelectOption = (type) => {
        const option = document.createElement("option");
        option.disabled = true;
        option.selected = true;
        option.value = true;
        option.innerHTML = `select a ${type}`;
        return option;
      };
 
      const createQuestionElement = (question) => {
        switch (question.type) {
          case "select": {
            const el = document.createElement(question.type);
            el.append(getDefaultSelectOption("value"));
            question.values.forEach((val) => {
              const option = document.createElement("option");
              option.innerHTML = val;
              el.append(option);
            });
            el.addEventListener("input", (e) => validateInput(e.target));
            return el;
          }
          case "radio": {
            const el = document.createElement("div");
            question.values.forEach((val) => {
              const innerEl = document.createElement("div");
              const inputEl = document.createElement("input");
              inputEl.type = question.type;
              inputEl.id = `${question.label}_${val}`;
              inputEl.name = question.label;
              inputEl.addEventListener("input", (e) => validateInput(e.target));
              innerEl.append(inputEl);
              const labelEl = document.createElement("label");
              labelEl.htmlFor = `${question.label}_${val}`;
              labelEl.innerText = val;
              innerEl.append(labelEl);
              el.append(innerEl);
            });
            return el;
          }
 
          case "checkbox": {
            const el = document.createElement("div");
            question.values.forEach((val) => {
              const innerEl = document.createElement("div");
              const inputEl = document.createElement("input");
              inputEl.type = question.type;
              inputEl.id = `${question.label}_${val}`;
              inputEl.name = question.label;
              inputEl.addEventListener("input", (e) => validateInput(e.target));
              innerEl.append(inputEl);
              const labelEl = document.createElement("label");
              labelEl.htmlFor = `${question.label}_${val}`;
              labelEl.innerText = val;
              innerEl.append(labelEl);
              el.append(innerEl);
            });
            return el;
          }
 
          case "text": {
            const el = document.createElement(question.type);
            const innerEl = document.createElement("div");
            const inputEl = document.createElement("input");
            inputEl.id = question.label;
            inputEl.type = question.type;
            inputEl.placeholder = "Enter your answer...";
            inputEl.addEventListener("input", (e) => validateInput(e.target));
            innerEl.append(inputEl);
            el.append(innerEl);
            return el;
          }
          case "email": {
            const el = document.createElement(question.type);
            const innerEl = document.createElement("div");
            const inputEl = document.createElement("input");
            inputEl.id = question.label;
            inputEl.type = question.type;
            inputEl.placeholder = "Enter your answer...";
            inputEl.addEventListener("input", (e) => validateInput(e.target));
            innerEl.append(inputEl);
            el.append(innerEl);
            return el;
          }
          case "number": {
            const el = document.createElement(question.type);
            const innerEl = document.createElement("div");
            const inputEl = document.createElement("input");
            inputEl.id = question.label;
            inputEl.type = question.type;
            inputEl.placeholder = "Enter your answer...";
            inputEl.addEventListener("input", (e) => validateInput(e.target));
            innerEl.append(inputEl);
            el.append(innerEl);
            return el;
          }
          case "textarea": {
            const el = document.createElement(question.type);
            const option = document.createElement("textarea");
            option.placeholder = "Enter your answer...";
            el.addEventListener("input", (e) => validateInput(e.target));
            el.append(option);
            return el;
          }
          default:
            throw Error(`implement ${question.type} option creation`);
        }
      };
 
      const loadDepartments = () => {
        const departmentSelect = document.getElementById("departments");
        departmentSelect.append(getDefaultSelectOption("department"));
        departments.forEach((department, i) => {
          const option = document.createElement("option");
          option.innerHTML = department;
          departmentSelect.append(option);
        });
        enable("departments");
      };
      const loadCourses = () => {
        if (document.getElementById("departments").value) {
          disable("nextButton", "submitButton");
          show("nextButton");
          hide("submitButton", "coursesSection", "questionsSection");
          clear("courses");
 
          const courseSelect = document.getElementById("courses");
          courseSelect.append(getDefaultSelectOption("course"));
          courses[document.getElementById("departments").value].forEach(
            (course, i) => {
              const option = document.createElement("option");
              option.innerHTML = course;
              courseSelect.append(option);
            }
          );
 
          enable("courses");
          show("coursesSection", "generalInfo");
          hide("generalInfo-collapse");
        } else {
          show("generalInfo");
          hide("coursesSection", "questionsSection", "generalInfo-collapse");
        }
      };
      const loadQuestions = () => {
        if (document.getElementById("courses").value) {
          disable("nextButton", "submitButton");
          show("nextButton");
          hide("submitButton", "questionsSection");
 
          const questionDiv = document.getElementById("questionsSection");
          questionDiv.innerHTML = "";
          commonQuestions.forEach((question) => {
            const formControlDiv = document.createElement("div");
            formControlDiv.classList.add("form-control");
            const label = document.createElement("label");
            label.innerText = question.label;
            formControlDiv.append(label);
            const questionEl = createQuestionElement(question);
            formControlDiv.append(questionEl);
            questionDiv.append(formControlDiv);
          });
          courseQuestions[document.getElementById("courses").value].forEach(
            (question) => {
              const formControlDiv = document.createElement("div");
              formControlDiv.classList.add("form-control");
              const label = document.createElement("label");
              label.innerText = question.label;
              formControlDiv.append(label);
              const questionEl = createQuestionElement(question);
              formControlDiv.append(questionEl);
              questionDiv.append(formControlDiv);
            }
          );
        } else {
          show("generalInfo");
          hide("questionsSection", "generalInfo-collapse");
        }
 
        document.getElementById("courses").value
          ? enable("nextButton")
          : disable("nextButton");
      };
 
      document
        .getElementById("departments")
        .addEventListener("change", loadCourses);
      document
        .getElementById("courses")
        .addEventListener("change", loadQuestions);
 
      document
        .getElementById("generalInfo-collapse")
        .addEventListener("click", (e) => {
          disable("nextButton", "submitButton");
          show("nextButton", "generalInfo");
          hide(
            "submitButton",
            "coursesSection",
            "questionsSection",
            "generalInfo-collapse"
          );
          clear("departments", "courses", "questionsSection");
 
          loadDepartments();
        });
 
      disable("nextButton", "submitButton");
 
      loadDepartments();
 
      const next = (e) => {
        disable("courses", "departments");
        enable("submitButton");
        show("generalInfo-collapse", "questionsSection", "submitButton");
        hide("generalInfo", "nextButton");
      };
      document.getElementById("nextButton").addEventListener("click", next);
      document.getElementById("submitButton").addEventListener("click", () => {
        if (
          Array.from(
            document
              .getElementById("questionsSection")
              .querySelectorAll("input, textarea, select")
          )
            .map(validateInput)
            .some((b) => !b)
        ) {
          alert("There are still input fields that do not have valid answers.");
        } else {
          alert("Survey is now complete, thank you for your time.");
        }
      });
    </script>
  </body>
</html>